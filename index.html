<!DOCTYPE html>
<html>
  <head>
  <title>Navigation Timing API</title>
  <link href="http://fonts.googleapis.com/css?family=Copse|Artifika&subset=latin" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="style.css">
  </head>
  <body>
    <div id="main">
      <h1>Breaking Down onLoad</h1>
      <div id="bm" class="fig">
      <a id="bookmarklet" href="javascript:((function(){(function(){function%20u(){if(!window.performance){return}var%20b=window.performance,d=b.timing,e={},f=d.navigationStart||0,g=k(d),h=[];duration=0;g.forEach(function(a){if(d[a]%26%26d[a]%3E0){duration=d[a]-f;h.push([a,duration]);if(duration%3Ec){c=duration}}});h.sort(function(b,c){return%20b[1]!==c[1]%3Fb[1]-c[1]:a.indexOf(b[0])-a.indexOf(c[0])});h.forEach(function(a){e[a[0]]=a[1]});return%20h}function%20t(a,b,c,h){var%20j,k,m,n,o,p=h.color,q=h.sectionData[0],r=h.sectionData[1],s=h.label,t=b.getContext(%222d%22);if(a===%22block%22){j=h.eventData[0];k=h.eventData[1];n=j+%22-%22+k}else{j=h.eventData[0];n=j}n+=%22ms%22;o=t.measureText(n);if(o.width%3Ee){e=o.width+10;g=e+f;i=l(b)}return%20function(b){if(a===%22block%22){m=Math.round((k-j)*i);m=m===0%3F1:m}else{m=1}b.strokeStyle=%22rgba(%22+p[0]+%22,%22+p[1]+%22,%22+p[2]+%22,.3)%22;b.lineWidth=1;b.fillStyle=%22rgba(255,255,255,.99)%22;b.fillRect(0,0,c-g,d);b.fillStyle=%22rgba(%22+p[0]+%22,%22+p[1]+%22,%22+p[2]+%22,.1)%22;b.fillRect(0,0,c-g,d);b.strokeRect(.5,.5,Math.round(c-g-1),Math.round(d));b.shadowColor=%22white%22;b.fillStyle=%22rgba(%22+p[0]+%22,%22+p[1]+%22,%22+p[2]+%22,.3)%22;b.fillRect(Math.round(i*q),0,Math.round(i*(r-q)),d);b.fillStyle=%22rgb(%22+p[0]+%22,%22+p[1]+%22,%22+p[2]+%22)%22;b.fillRect(Math.round(i*j),0,m,d);b.fillText(n,c-g+10,2*d/3);b.fillText(s,c-g+e+10,2*d/3)}}function%20s(a,b,c,d,e,f){var%20g={color:f.color,sectionData:[f.barStart,f.barEnd],eventData:e.map(function(a){return%20b[a]%26%26typeof%20b[a].time!==%22undefined%22%3Fb[a].time:a}),label:f.label};return%20t(d,a,c,g)}function%20r(c){var%20d={},e,f,g,h,i,j,k,l;c.forEach(function(a){d[a[0]]={time:a[1]}});for(g=0,i=b.length;g%3Ci;g++){e=b[g].start;f=b[g].end;k=a.slice(e,f+1);l=k.filter(function(a){return%20d.hasOwnProperty(a)});l.sort(function(a,b){return%20d[a].time-d[b].time});e=l[0];f=l[l.length-1];for(h=0,j=l.length;h%3Cj;h++){var%20m=l[h];if(d[m]){d[m].color=b[g].color;d[m].barStart=d[e].time;d[m].barEnd=d[f].time}}}return%20d}function%20q(b,c){var%20e,f,g,j,k,m,n=[],p=[],q,t=%2212px%20Arial%22,u,v,w=document.createElement(%22div%22),x=o(),y=r(c);u=document.createElement(%22canvas%22);u.width=parseInt(window.getComputedStyle(b).width,10)-20;v=u.getContext(%222d%22);v.font=t;i=l(u);q=s.bind(this,u,y,u.width);for(var%20z%20in%20y){j=y[z];f=z.indexOf(%22Start%22);g=-1;if(f%3E-1){k=z.substr(0,f);g=a.indexOf(k+%22End%22)}if(f%3E-1%26%26g%3E-1){j.label=k;p.push(q(%22block%22,[k+%22Start%22,k+%22End%22,k],j));n.push(k+%22End%22)}else%20if(n.indexOf(z)%3C0){j.label=z;p.push(q(%22point%22,[z],j))}}u.height=h*d*p.length;v.font=t;p.forEach(function(a){a(v);v.translate(0,Math.round(d*h))});w.appendChild(u);w.appendChild(x);return%20w}function%20p(){var%20a=document.createElement(%22p%22);a.innerHTML=%22Navigation%20Timing%20API%20is%20not%20supported%20by%20your%20browser%22;return%20a}function%20o(){var%20a=document.createElement(%22a%22);a.target=%22_blank%22;a.href=%22http://kaaes.github.com/timing/info.html%22;a.innerHTML=%22What%20does%20it%20all%20mean%3F%22;a.style.cssText=%22color:%231D85B8%22;return%20a}function%20n(a){var%20b=document.createElement(%22div%22),c=document.createElement(%22h1%22),d=document.createElement(%22button%22);c.innerHTML=%22Page%20Load%20Time%20Breakdown%22;c.style.cssText=%22font-family:Helvetica,Calibri,Arial,sans-serif;text-shadow:none;display:inline-block;color:%23222;font-weight:normal;font-size:24px;margin:10px%200%22;d.innerHTML=%22close%22;d.style.cssText=%22font-family:Helvetica,Calibri,Arial,sans-serif;text-shadow:none;float:right;border:none;background:%23333;color:%23fff;border-radius:10px;padding:3px%2010px;font-size:12px;%22;d.addEventListener(%22click%22,function(b){a.parentNode.removeChild(a)});b.appendChild(c);b.appendChild(d);return%20b}function%20m(){var%20a=document.createElement(%22div%22);document.body.appendChild(a);a.style.cssText=%22font-size:14px;font-family:Helvetica,Calibri,Arial,sans-serif;text-shadow:none;text-align:left;width:95%25;position:fixed;z-index:999;margin:0%20auto;top:20px;left:20px;background:rgba(255,253,242,.95);padding:10px;box-shadow:0%200%2010px%205px%20rgba(0,0,0,.5),0%200%200%2010px%20rgba(0,0,0,.5);%20border-radius:1px%22;return%20a}function%20l(a){return(a.width-g)/c}function%20k(a){var%20b=Object.keys(a);return%20b.length%3Fb:Object.keys(Object.getPrototypeOf(a))}var%20a=[%22navigationStart%22,%22redirectStart%22,%22redirectStart%22,%22redirectEnd%22,%22fetchStart%22,%22domainLookupStart%22,%22domainLookupEnd%22,%22connectStart%22,%22secureConnectionStart%22,%22connectEnd%22,%22requestStart%22,%22responseStart%22,%22responseEnd%22,%22unloadEventStart%22,%22unloadEventEnd%22,%22domLoading%22,%22domInteractive%22,%22domContentLoadedEventStart%22,%22domContentLoadedEventEnd%22,%22domContentLoaded%22,%22domComplete%22,%22loadEventStart%22,%22loadEventEnd%22];var%20b=[{name:%22network%22,color:[224,84,63],start:a.indexOf(%22navigationStart%22),end:a.indexOf(%22connectEnd%22)},{name:%22server%22,color:[255,188,0],start:a.indexOf(%22requestStart%22),end:a.indexOf(%22responseEnd%22)},{name:%22browser%22,color:[16,173,171],start:a.indexOf(%22unloadEventStart%22),end:a.indexOf(%22loadEventEnd%22)}];var%20c=0,d=20,e=50,f=150,g=e+f,h=1.25,i=1,j={};(function%20v(){var%20a=m(),b=u();a.appendChild(n(a));a.appendChild(b%3Fq(a,b):p())})()})()})());">Loadtime Breakdown</a>
      
      <p>
        drag the button to bookmarks toolbar<br /> &darr; <br />click it on any page you want to check
      </p>
      <p class="footnote">you may also click it first here to see what it does</p>
      </div>
      <p>This script uses <a href="https://dvcs.w3.org/hg/webperf/raw-file/tip/specs/NavigationTiming/Overview.html">Navigation Timing object</a> to present timing of different phases of loading the page by a browser.</p>
      <p>It measures everything from triggering the action (hitting enter on url bar, refreshing page or clicking a link/button) to the moment when site is fully loaded. Adding it to your bookmarks allows you to analyze performance of every request you'd like to check out.</p>
      <p class="fig"><img id="chart" src="chart.png" alt="Sample chart generated by bookmarklet" /></p>
      <p>So far Navigation Timing API works in Firefox 7+, Chrome (buggy in 15*) and IE 9+</p>
      <p>* &lt;tech blah&gt;According to <a href="https://dvcs.w3.org/hg/webperf/raw-file/tip/specs/NavigationTiming/Overview.html#sec-window.performance-attribute">W3C spec</a> <code>window.performance</code> should be implemented as <a href="http://www.w3.org/TR/WebIDL/#Replaceable">WebIDL [Replaceable] attribute</a>.&lt;/tech blah&gt;</p>
      <p>
      In human language it means that its properties are in fact not its own but its prototype. 
      So you can access the values with plain <code>performance.timing</code> but 
      using <code>Object</code> methods will not have the result you might expect. In Chrome however <code>performance</code> behaves like a 'normal' object:</p>
      <pre>
performance.timing
  // connectEnd: 1321394207437
  // connectStart: 1321394207437
  // domComplete: 1321394207768
  // ...
  // redirectEnd: 0
  // redirectStart: 0
  // ...

performance.hasOwnProperty("timing");
  // should be false but true in Chrome
Object.getPrototypeOf(performance).hasOwnProperty("timing");
  // should be true but false in Chrome

Object.keys(performance);
  // should be [] but is ["memory", "timing", "navigation"] in Chrome
Object.keys(Object.getPrototypeOf(performance));
  // should be ["timing", "navigation"] but is [] in Chrome
</pre>
      <p>More resources:</p>
      <ul>
        <li><a href="http://www.html5rocks.com/en/tutorials/webperformance/basics/">HTML5 Rocks - Measuring Page Load Speed with Navigation Timing</a></li>
        <li><a href="http://msdn.microsoft.com/en-us/library/ff975075">MSDN - performanceTiming Object</a></li>
        <li><a href="info.html">My description of performance.timing properties based on all of the above</a></li>
      </ul>
      </div>
      <a href="https://github.com/kaaes/timing"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://a248.e.akamai.net/assets.github.com/img/e6bef7a091f5f3138b8cd40bc3e114258dd68ddf/687474703a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f7265645f6161303030302e706e67" alt="Fork me on GitHub"></a>
      <a href="javascript:((function()%7Bfunction%20u()%7Bif(!window.performance)%7Breturn%7Dvar%20b%3Dwindow.performance%2Cd%3Db.timing%2Ce%3D%7B%7D%2Cf%3Dd.navigationStart%7C%7C0%2Cg%3Dk(d)%2Ch%3D%5B%5D%3Bduration%3D0%3Bg.forEach(function(a)%7Bif(d%5Ba%5D%26%26d%5Ba%5D%3E0)%7Bduration%3Dd%5Ba%5D-f%3Bh.push(%5Ba%2Cduration%5D)%3Bif(duration%3Ec)%7Bc%3Dduration%7D%7D%7D)%3Bh.sort(function(b%2Cc)%7Breturn%20b%5B1%5D!%3D%3Dc%5B1%5D%3Fb%5B1%5D-c%5B1%5D%3Aa.indexOf(b%5B0%5D)-a.indexOf(c%5B0%5D)%7D)%3Bh.forEach(function(a)%7Be%5Ba%5B0%5D%5D%3Da%5B1%5D%7D)%3Breturn%20h%7Dfunction%20t(a%2Cb%2Cc%2Ch)%7Bvar%20j%2Ck%2Cm%2Cn%2Co%2Cp%3Dh.color%2Cq%3Dh.sectionData%5B0%5D%2Cr%3Dh.sectionData%5B1%5D%2Cs%3Dh.label%2Ct%3Db.getContext(%222d%22)%3Bif(a%3D%3D%3D%22block%22)%7Bj%3Dh.eventData%5B0%5D%3Bk%3Dh.eventData%5B1%5D%3Bn%3Dj%2B%22-%22%2Bk%7Delse%7Bj%3Dh.eventData%5B0%5D%3Bn%3Dj%7Dn%2B%3D%22ms%22%3Bo%3Dt.measureText(n)%3Bif(o.width%3Ee)%7Be%3Do.width%2B10%3Bg%3De%2Bf%3Bi%3Dl(b)%7Dreturn%20function(b)%7Bif(a%3D%3D%3D%22block%22)%7Bm%3DMath.round((k-j)*i)%3Bm%3Dm%3D%3D%3D0%3F1%3Am%7Delse%7Bm%3D1%7Db.strokeStyle%3D%22rgba(%22%2Bp%5B0%5D%2B%22%2C%22%2Bp%5B1%5D%2B%22%2C%22%2Bp%5B2%5D%2B%22%2C.3)%22%3Bb.lineWidth%3D1%3Bb.fillStyle%3D%22rgba(255%2C255%2C255%2C.99)%22%3Bb.fillRect(0%2C0%2Cc-g%2Cd)%3Bb.fillStyle%3D%22rgba(%22%2Bp%5B0%5D%2B%22%2C%22%2Bp%5B1%5D%2B%22%2C%22%2Bp%5B2%5D%2B%22%2C.1)%22%3Bb.fillRect(0%2C0%2Cc-g%2Cd)%3Bb.strokeRect(.5%2C.5%2CMath.round(c-g-1)%2CMath.round(d))%3Bb.shadowColor%3D%22white%22%3Bb.fillStyle%3D%22rgba(%22%2Bp%5B0%5D%2B%22%2C%22%2Bp%5B1%5D%2B%22%2C%22%2Bp%5B2%5D%2B%22%2C.3)%22%3Bb.fillRect(Math.round(i*q)%2C0%2CMath.round(i*(r-q))%2Cd)%3Bb.fillStyle%3D%22rgb(%22%2Bp%5B0%5D%2B%22%2C%22%2Bp%5B1%5D%2B%22%2C%22%2Bp%5B2%5D%2B%22)%22%3Bb.fillRect(Math.round(i*j)%2C0%2Cm%2Cd)%3Bb.fillText(n%2Cc-g%2B10%2C2*d%2F3)%3Bb.fillText(s%2Cc-g%2Be%2B10%2C2*d%2F3)%7D%7Dfunction%20s(a%2Cb%2Cc%2Cd%2Ce%2Cf)%7Bvar%20g%3D%7Bcolor%3Af.color%2CsectionData%3A%5Bf.barStart%2Cf.barEnd%5D%2CeventData%3Ae.map(function(a)%7Breturn%20b%5Ba%5D%26%26typeof%20b%5Ba%5D.time!%3D%3D%22undefined%22%3Fb%5Ba%5D.time%3Aa%7D)%2Clabel%3Af.label%7D%3Breturn%20t(d%2Ca%2Cc%2Cg)%7Dfunction%20r(c)%7Bvar%20d%3D%7B%7D%2Ce%2Cf%2Cg%2Ch%2Ci%2Cj%2Ck%2Cl%3Bc.forEach(function(a)%7Bd%5Ba%5B0%5D%5D%3D%7Btime%3Aa%5B1%5D%7D%7D)%3Bfor(g%3D0%2Ci%3Db.length%3Bg%3Ci%3Bg%2B%2B)%7Be%3Db%5Bg%5D.start%3Bf%3Db%5Bg%5D.end%3Bk%3Da.slice(e%2Cf%2B1)%3Bl%3Dk.filter(function(a)%7Breturn%20d.hasOwnProperty(a)%7D)%3Bl.sort(function(a%2Cb)%7Breturn%20d%5Ba%5D.time-d%5Bb%5D.time%7D)%3Be%3Dl%5B0%5D%3Bf%3Dl%5Bl.length-1%5D%3Bfor(h%3D0%2Cj%3Dl.length%3Bh%3Cj%3Bh%2B%2B)%7Bvar%20m%3Dl%5Bh%5D%3Bif(d%5Bm%5D)%7Bd%5Bm%5D.color%3Db%5Bg%5D.color%3Bd%5Bm%5D.barStart%3Dd%5Be%5D.time%3Bd%5Bm%5D.barEnd%3Dd%5Bf%5D.time%7D%7D%7Dreturn%20d%7Dfunction%20q(b%2Cc)%7Bvar%20e%2Cf%2Cg%2Cj%2Ck%2Cm%2Cn%3D%5B%5D%2Cp%3D%5B%5D%2Cq%2Ct%3D%2212px%20Arial%22%2Cu%2Cv%2Cw%3Ddocument.createElement(%22div%22)%2Cx%3Do()%2Cy%3Dr(c)%3Bu%3Ddocument.createElement(%22canvas%22)%3Bu.width%3DparseInt(window.getComputedStyle(b).width%2C10)-20%3Bv%3Du.getContext(%222d%22)%3Bv.font%3Dt%3Bi%3Dl(u)%3Bq%3Ds.bind(this%2Cu%2Cy%2Cu.width)%3Bfor(var%20z%20in%20y)%7Bj%3Dy%5Bz%5D%3Bf%3Dz.indexOf(%22Start%22)%3Bg%3D-1%3Bif(f%3E-1)%7Bk%3Dz.substr(0%2Cf)%3Bg%3Da.indexOf(k%2B%22End%22)%7Dif(f%3E-1%26%26g%3E-1)%7Bj.label%3Dk%3Bp.push(q(%22block%22%2C%5Bk%2B%22Start%22%2Ck%2B%22End%22%2Ck%5D%2Cj))%3Bn.push(k%2B%22End%22)%7Delse%20if(n.indexOf(z)%3C0)%7Bj.label%3Dz%3Bp.push(q(%22point%22%2C%5Bz%5D%2Cj))%7D%7Du.height%3Dh*d*p.length%3Bv.font%3Dt%3Bp.forEach(function(a)%7Ba(v)%3Bv.translate(0%2CMath.round(d*h))%7D)%3Bw.appendChild(u)%3Bw.appendChild(x)%3Breturn%20w%7Dfunction%20p()%7Bvar%20a%3Ddocument.createElement(%22p%22)%3Ba.innerHTML%3D%22Navigation%20Timing%20API%20is%20not%20supported%20by%20your%20browser%22%3Breturn%20a%7Dfunction%20o()%7Bvar%20a%3Ddocument.createElement(%22a%22)%3Ba.href%3D%22http%3A%2F%2Fkaaes.github.com%2Ftiming%2Finfo.html%22%3Ba.target%3D%22_blank%22%3Ba.innerHTML%3D%22What%20does%20it%20all%20mean%3F%22%3Ba.style.cssText%3D%22color%3A%231D85B8%22%3Breturn%20a%7Dfunction%20n(a)%7Bvar%20b%3Ddocument.createElement(%22div%22)%2Cc%3Ddocument.createElement(%22h1%22)%2Cd%3Ddocument.createElement(%22button%22)%3Bc.innerHTML%3D%22Page%20Load%20Time%20Breakdown%22%3Bc.style.cssText%3D%22font-family%3AHelvetica%2CCalibri%2CArial%2Csans-serif%3Btext-shadow%3Anone%3Bdisplay%3Ainline-block%3Bcolor%3A%23222%3Bfont-weight%3Anormal%3Bfont-size%3A24px%3Bmargin%3A10px%200%22%3Bd.innerHTML%3D%22close%22%3Bd.style.cssText%3D%22font-family%3AHelvetica%2CCalibri%2CArial%2Csans-serif%3Btext-shadow%3Anone%3Bfloat%3Aright%3Bborder%3Anone%3Bbackground%3A%23333%3Bcolor%3A%23fff%3Bborder-radius%3A10px%3Bpadding%3A3px%2010px%3Bfont-size%3A12px%3B%22%3Bd.addEventListener(%22click%22%2Cfunction(b)%7Ba.parentNode.removeChild(a)%7D)%3Bb.appendChild(c)%3Bb.appendChild(d)%3Breturn%20b%7Dfunction%20m()%7Bvar%20a%3Ddocument.createElement(%22div%22)%3Bdocument.body.appendChild(a)%3Ba.style.cssText%3D%22font-size%3A14px%3Bfont-family%3AHelvetica%2CCalibri%2CArial%2Csans-serif%3Btext-shadow%3Anone%3Btext-align%3Aleft%3Bwidth%3A95%25%3Bposition%3Afixed%3Bz-index%3A999%3Bmargin%3A0%20auto%3Btop%3A20px%3Bleft%3A20px%3Bbackground%3Argba(255%2C253%2C242%2C.95)%3Bpadding%3A10px%3Bbox-shadow%3A0%200%2010px%205px%20rgba(0%2C0%2C0%2C.5)%2C0%200%200%2010px%20rgba(0%2C0%2C0%2C.5)%3B%20border-radius%3A1px%22%3Breturn%20a%7Dfunction%20l(a)%7Breturn(a.width-g)%2Fc%7Dfunction%20k(a)%7Bvar%20b%3DObject.keys(a)%3Breturn%20b.length%3Fb%3AObject.keys(Object.getPrototypeOf(a))%7Dvar%20a%3D%5B%22navigationStart%22%2C%22redirectStart%22%2C%22redirectStart%22%2C%22redirectEnd%22%2C%22fetchStart%22%2C%22domainLookupStart%22%2C%22domainLookupEnd%22%2C%22connectStart%22%2C%22secureConnectionStart%22%2C%22connectEnd%22%2C%22requestStart%22%2C%22responseStart%22%2C%22responseEnd%22%2C%22unloadEventStart%22%2C%22unloadEventEnd%22%2C%22domLoading%22%2C%22domInteractive%22%2C%22domContentLoadedEventStart%22%2C%22domContentLoadedEventEnd%22%2C%22domContentLoaded%22%2C%22domComplete%22%2C%22loadEventStart%22%2C%22loadEventEnd%22%5D%3Bvar%20b%3D%5B%7Bname%3A%22network%22%2Ccolor%3A%5B224%2C84%2C63%5D%2Cstart%3Aa.indexOf(%22navigationStart%22)%2Cend%3Aa.indexOf(%22connectEnd%22)%7D%2C%7Bname%3A%22server%22%2Ccolor%3A%5B255%2C188%2C0%5D%2Cstart%3Aa.indexOf(%22requestStart%22)%2Cend%3Aa.indexOf(%22responseEnd%22)%7D%2C%7Bname%3A%22browser%22%2Ccolor%3A%5B16%2C173%2C171%5D%2Cstart%3Aa.indexOf(%22unloadEventStart%22)%2Cend%3Aa.indexOf(%22loadEventEnd%22)%7D%5D%3Bvar%20c%3D0%2Cd%3D20%2Ce%3D50%2Cf%3D150%2Cg%3De%2Bf%2Ch%3D1.25%2Ci%3D1%2Cj%3D%7B%7D%3B(function%20v()%7Bvar%20a%3Dm()%2Cb%3Du()%3Ba.appendChild(n(a))%3Ba.appendChild(b%3Fq(a%2Cb)%3Ap())%7D)()%7D)())">alternative</a>
  </body>
</html>
