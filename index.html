<!DOCTYPE html>
<html>
  <head>
  <title>Navigation Timing API</title>
  <link href="http://fonts.googleapis.com/css?family=Copse|Artifika&subset=latin" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="style.css">
  </head>
  <body>
    <div id="main">
      <h1>Breaking Down onLoad</h1>
      <div id="bm" class="fig">
      <a id="bookmarklet" href="javascript:(function(){if(!document.getElementById(%27bmrklt%27))%20{var%20h=%20document.getElementsByTagName(%27head%27)[0],s%20=%20document.createElement(%27script%27);s.type=%20%27text/javascript%27;s.id=%27bmrklt%27;s.src=%20%27http://kaaes.github.com/timing/timing.js%27;h.appendChild(s);}%20else%20{Profiler();}})()">Loadtime Breakdown</a>
      
      <p>
        drag the button to bookmarks toolbar<br /> &darr; <br />click it on any page you want to check
      </p>
      <p class="footnote">you may also click it first here to see what it does</p>
      </div>
      <p>This script uses <a href="https://dvcs.w3.org/hg/webperf/raw-file/tip/specs/NavigationTiming/Overview.html">Navigation Timing object</a> to present timing of different phases of loading the page by a browser.</p>
      <p>It measures everything from triggering the action (hitting enter on url bar, refreshing page or clicking a link/button) to the moment when site is fully loaded. Adding it to your bookmarks allows you to analyze performance of every request you'd like to check out.</p>
      <p class="fig"><img id="chart" src="chart.png" alt="Sample chart generated by bookmarklet" /></p>
      <p>So far Navigation Timing API works in Firefox 7+, Chrome (buggy in 15*) and IE 9+</p>
      <p>* &lt;tech blah&gt;According to <a href="https://dvcs.w3.org/hg/webperf/raw-file/tip/specs/NavigationTiming/Overview.html#sec-window.performance-attribute">W3C spec</a> <code>window.performance</code> should be implemented as <a href="http://www.w3.org/TR/WebIDL/#Replaceable">WebIDL [Replaceable] attribute</a>.&lt;/tech blah&gt;</p>
      <p>
      In human language it means that its properties are in fact not its own but its prototype. 
      So you can access the values with plain <code>performance.timing</code> but 
      using <code>Object</code> methods will not have the result you might expect. In Chrome however <code>performance</code> behaves like a 'normal' object:</p>
      <pre>
performance.timing
  // connectEnd: 1321394207437
  // connectStart: 1321394207437
  // domComplete: 1321394207768
  // ...
  // redirectEnd: 0
  // redirectStart: 0
  // ...

performance.hasOwnProperty("timing");
  // should be false but true in Chrome
Object.getPrototypeOf(performance).hasOwnProperty("timing");
  // should be true but false in Chrome

Object.keys(performance);
  // should be [] but is ["memory", "timing", "navigation"] in Chrome
Object.keys(Object.getPrototypeOf(performance));
  // should be ["timing", "navigation"] but is [] in Chrome
</pre>
      <p>More resources:</p>
      <ul>
        <li><a href="http://www.html5rocks.com/en/tutorials/webperformance/basics/">HTML5 Rocks - Measuring Page Load Speed with Navigation Timing</a></li>
        <li><a href="http://msdn.microsoft.com/en-us/library/ff975075">MSDN - performanceTiming Object</a></li>
        <li><a href="info.html">My description of performance.timing properties based on all of the above</a></li>
      </ul>
      </div>
      <a href="https://github.com/kaaes/timing"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://a248.e.akamai.net/assets.github.com/img/e6bef7a091f5f3138b8cd40bc3e114258dd68ddf/687474703a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f7265645f6161303030302e706e67" alt="Fork me on GitHub"></a>
  </body>
</html>
